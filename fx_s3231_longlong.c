#include "fx_s3231_double.h"

const fx_s3231 fx_3231_sinTable[92] = {
    0, 37478757, 74946098, 112390610, 149800886, 187165532, 224473165, 261712422, 298871958, 335940455,
    372906622, 409759197, 446486956, 483078710, 519523314, 555809667, 591926714, 627863455, 663608942,
    699152288, 734482665, 769589311, 804461533, 839088709, 873460290, 907565806, 941394869,
    974937174, 1008182504, 1041120731, 1073741824, 1106035843, 1137992954, 1169603421, 1200857616,
    1231746017, 1262259217, 1292387921, 1322122950, 1351455249, 1380375880, 1408876036, 1436947035,
    1464580326, 1491767491, 1518500249, 1544770458, 1570570115, 1595891360, 1620726482, 1645067915,
    1668908244, 1692240207, 1715056698, 1737350766, 1759115620, 1780344630, 1801031330, 1821169419,
    1840752761, 1859775393, 1878231519, 1896115517, 1913421940, 1930145517, 1946281152, 1961823931,
    1976769120, 1991112166, 2004848699, 2017974537, 2030485679, 2042378317, 2053648825, 2064293773,
    2074309917, 2083694205, 2092443781, 2100555977, 2108028324, 2114858546, 2121044560, 2126584484,
    2131476630, 2135719507, 2139311824, 2142252485, 2144540596, 2146175458, 2147156575, 2147483648,
    2147156575};

fx_s3231 fx_3231_longlong_sin(fx_s3231 a)
{
    int angle = a >> 31;
    float roundValue = (a >> 20) / 2048.0 - angle;
    int sign = 1;
    if (angle < 0)
    {
        sign = -1;
        angle *= -1;
    }
    angle = angle % 360;
    if (angle >= 180)
    {
        sign *= -1;
        angle -= 180;
    }
    if (angle > 90)
    {
        angle = 180 - angle;
    }
    if (roundValue == 0)
        return ((sign) * (fx_3231_sinTable[angle]));
    else
    {
        return (fx_s3231)((sign) * ((fx_3231_sinTable[angle] * (1 - roundValue)) + (fx_3231_sinTable[angle + 1] * (roundValue))));
    }
}
